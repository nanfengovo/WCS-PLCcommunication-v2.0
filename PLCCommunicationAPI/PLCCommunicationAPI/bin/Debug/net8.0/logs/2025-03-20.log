2025-03-20 00:40:00.1398|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 48
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:01:31.5642|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 48
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:02:11.6038|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 48
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:13:59.2476|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 49
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:20:43.2152|FATAL|ScheduledTasksService.S7.S7TaskService|后台服务启动失败 System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 48
2025-03-20 19:20:43.2759|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start System.InvalidOperationException: No service for type 'PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 48
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:24:03.0629|INFO|ScheduledTasksService.S7.S7TaskService|数据库初始化成功 
2025-03-20 19:24:03.1051|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:24:05.2181|FATAL|ScheduledTasksService.S7.S7TaskService|后台服务启动失败 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 135
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 54
2025-03-20 19:24:05.2657|ERROR|Microsoft.Extensions.Hosting.Internal.Host|Hosting failed to start S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 135
   at ScheduledTasksService.S7.S7TaskService.StartAsync(CancellationToken cancellationToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 54
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-03-20 19:32:16.7806|INFO|ScheduledTasksService.S7.S7TaskService|数据库初始化成功 
2025-03-20 19:32:16.8139|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:32:16.8485|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:32:16与配置名为：Test的PLC建立连接: 
2025-03-20 19:32:16.8683|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:32:17.0973|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 19:32:17.0973|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 19:32:17.1535|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 19:32:17.1535|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 19:32:17.1535|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 19:47:45.0721|INFO|ScheduledTasksService.S7.S7TaskService|数据库初始化成功 
2025-03-20 19:47:45.2917|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 19:47:45.2917|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 19:47:45.3447|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 19:47:45.3447|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 19:47:45.3447|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 19:48:28.1841|INFO|ScheduledTasksService.S7.S7TaskService|数据库初始化成功 
2025-03-20 19:48:28.3871|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 19:48:28.3871|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 19:48:28.4401|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 19:48:28.4410|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 19:48:28.4410|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 19:52:04.2966|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:04.2966|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 19:52:04.3312|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 19:52:04.3649|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:04与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:04.3879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:04.4238|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 19:52:04.4246|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 19:52:04.4246|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 19:52:06.4402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:06.4619|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:06与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:06.4619|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:08.5663|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:08.5663|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:08与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:08.5663|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:10.5824|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:10.5824|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:10与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:10.5824|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:12.6059|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:12.6059|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:12与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:12.6145|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:14.6257|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:14.6315|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:14与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:14.6315|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:16.6431|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:16.6487|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:16与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:16.6487|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:18.6720|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:18.6760|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:18与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:18.6760|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:20.6917|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:20.6917|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:20与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:20.6917|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:22.7096|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:22.7096|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:22与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:22.7096|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:24.7484|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:24.7484|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:24与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:24.7542|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:26.7789|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:26.7789|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:26与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:26.7847|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:28.8262|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:28.8262|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:28与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:28.8354|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:30.8391|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:30.8391|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:30与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:30.8391|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:32.8582|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:32.8582|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:32与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:32.8631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:34.8705|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:34.8705|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:34与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:34.8705|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:36.8882|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:36.8882|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:36与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:36.8945|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:38.9112|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:38.9112|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:38与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:38.9112|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:40.9411|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:40.9495|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:40与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:40.9593|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:42.9742|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:42.9742|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:42与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:42.9742|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:44.9893|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:44.9893|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:44与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:44.9893|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:47.0081|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:47.0081|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:47与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:47.0185|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:49.0381|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:49.0381|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:49与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:49.0498|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:51.0619|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:51.0677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:51与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:51.0677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:53.0802|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:53.0864|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:53与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:53.0864|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:55.0964|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:55.1033|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:55与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:55.1033|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:57.1337|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:57.1337|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:57与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:57.1439|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:52:59.1525|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:52:59.1525|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:52:59与配置名为：Test的PLC建立连接: 
2025-03-20 19:52:59.1597|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:01.1754|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:01.1754|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:01与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:01.1754|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:03.2025|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:03.2071|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:03与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:03.2071|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:05.2238|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:05.2238|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:05与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:05.2238|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:07.2413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:07.2413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:07与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:07.2545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:09.2634|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:09.2695|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:09与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:09.2695|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:11.2826|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:11.2876|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:11与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:11.2876|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:13.3006|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:13.3006|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:13与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:13.3006|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:15.3297|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:15.3366|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:15与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:15.3366|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:17.3545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:17.3545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:17与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:17.3545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:19.3788|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:19.3788|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:19与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:19.3788|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:21.4005|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:21.4005|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:21与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:21.4005|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:23.4219|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:23.4286|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:23与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:23.4286|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:25.4455|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:25.4455|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:25与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:25.4455|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为0 
2025-03-20 19:53:27.4632|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:27.4731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:27与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:27.4731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:29.4939|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:29.4939|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:29与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:29.4939|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:31.5125|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:31.5125|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:31与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:31.5194|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:33.5457|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:33.5537|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:33与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:33.5537|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:35.5595|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:35.5595|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:35与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:35.5666|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:37.5794|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:37.5836|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:37与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:37.5836|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:39.5972|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:39.6003|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:39与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:39.6003|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:41.6110|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:41.6157|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:41与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:41.6157|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:43.6233|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:43.6306|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:43与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:43.6306|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:45.6453|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:45.6453|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:45与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:45.6453|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:47.6638|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:47.6638|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:47与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:47.6743|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:49.6916|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:49.6916|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:49与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:49.6916|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:51.7144|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:51.7144|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:51与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:51.7144|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:53.7316|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:53.7437|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:53与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:53.7437|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:55.7557|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:55.7557|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:55与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:55.7557|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:57.7737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:57.7737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:57与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:57.7737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:53:59.7975|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:53:59.8033|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:53:59与配置名为：Test的PLC建立连接: 
2025-03-20 19:53:59.8033|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:01.8217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:01.8217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:01与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:01.8217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:03.8450|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:03.8493|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:03与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:03.8493|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:05.8562|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:05.8562|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:05与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:05.8562|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:07.8724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:07.8724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:07与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:07.8724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:09.8948|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:09.8948|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:09与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:09.8948|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:11.9180|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:11.9180|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:11与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:11.9180|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:13.9382|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:13.9431|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:13与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:13.9431|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:15.9588|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:15.9588|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:15与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:15.9588|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:17.9761|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:17.9761|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:17与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:17.9898|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:19.9992|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:19.9992|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:20与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:20.0070|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:22.0211|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:22.0211|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:22与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:22.0211|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:24.0333|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:24.0374|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:24与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:24.0374|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:26.0551|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:26.0551|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:26与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:26.0551|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:28.0733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:28.0806|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:28与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:28.0806|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:30.0859|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:30.0859|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:30与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:30.0859|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:32.1032|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:32.1032|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:32与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:32.1032|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:34.1287|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:34.1287|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:34与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:34.1287|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:36.1504|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:36.1504|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:36与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:36.1504|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:38.1681|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:38.1681|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:38与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:38.1681|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:40.1836|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:40.1836|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:40与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:40.1836|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:42.2003|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:42.2003|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:42与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:42.2003|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:44.2217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:44.2217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:44与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:44.2217|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:46.2405|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:46.2405|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:46与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:46.2405|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:48.2635|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:48.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:48与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:48.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:50.2892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:50.2892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:50与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:50.2892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:52.3080|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:52.3080|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:52与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:52.3080|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:54.3238|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:54.3238|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:54与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:54.3311|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:56.3420|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:56.3420|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:56与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:56.3480|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:54:58.3574|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:54:58.3620|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:54:58与配置名为：Test的PLC建立连接: 
2025-03-20 19:54:58.3620|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:55:00.3761|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:55:00.3873|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:55:00与配置名为：Test的PLC建立连接: 
2025-03-20 19:55:00.3873|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:55:02.4065|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:55:02.4129|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:55:02与配置名为：Test的PLC建立连接: 
2025-03-20 19:55:02.4129|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:55:04.4207|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:55:04.4262|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:55:04与配置名为：Test的PLC建立连接: 
2025-03-20 19:55:04.4262|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:55:06.4423|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:55:06.4423|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:55:06与配置名为：Test的PLC建立连接: 
2025-03-20 19:55:06.4608|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:55:08.4764|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 19:55:22.6622|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 19:55:22与配置名为：Test的PLC建立连接: 
2025-03-20 19:55:26.1175|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 19:59:56.1823|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:00:02.9669|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:00:02与配置名为：Test的PLC建立连接: 
2025-03-20 20:00:03.7491|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:09:50.5186|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:09:50.5539|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:09:50.6674|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:09:50.6674|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:09:50.6674|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:12:30.5707|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:12:30.5919|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:12:30.6477|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:12:30.6477|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:12:30.6477|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:16:02.3370|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:16:02.3524|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:16:02.3984|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:16:02.3984|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:16:02.3984|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:16:12.0415|INFO|Microsoft.Hosting.Lifetime|Application is shutting down... 
2025-03-20 20:16:12.0952|ERROR|ScheduledTasksService.S7.S7TaskService|后台任务执行失败 System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at ScheduledTasksService.S7.S7TaskService.ExecuteAsync(CancellationToken stoppingToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 87
2025-03-20 20:16:31.1588|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:16:31.1768|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:16:31.2269|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:16:31.2269|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:16:31.2269|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:21:08.0090|INFO|ScheduledTasksService.S7.S7TaskService|数据库初始化成功 
2025-03-20 20:21:13.6245|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:21:13.6319|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:21:13.7260|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:21:13.7260|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:21:13.7260|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:22:41.3738|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:22:41.7718|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:22:41.7718|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:22:41.8734|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:22:41.8734|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:22:41.8734|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:22:58.4069|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:22:58.6648|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:22:58.6648|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:22:58.7217|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:22:58.7217|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:22:58.7217|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:23:30.1988|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:23:30.4182|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:23:30.4182|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:23:30.4672|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:23:30.4672|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:23:30.4672|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:24:25.5939|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:24:25.8324|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:24:25.8324|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:24:25.8832|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:24:25.8832|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:24:25.8832|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:26:56.0179|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:27:09.9393|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:27:15.7514|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:27:15与配置名为：Test的PLC建立连接: 
2025-03-20 20:27:17.0687|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:27:22.1370|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:27:22.1447|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:27:22.2602|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:27:22.2602|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:27:22.2602|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:27:35.9698|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:27:47.4038|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:27:47与配置名为：Test的PLC建立连接: 
2025-03-20 20:27:48.7788|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:28:29.7503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:28:29.7624|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:28:29与配置名为：Test的PLC建立连接: 
2025-03-20 20:28:29.7624|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:28:29.7624|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:28:31.8534|ERROR|ScheduledTasksService.S7.S7TaskService|后台任务执行失败 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync()
   at ScheduledTasksService.S7.S7TaskService.ExecuteAsync(CancellationToken stoppingToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 85
2025-03-20 20:28:31.8934|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:28:31.8934|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:28:31与配置名为：Test的PLC建立连接: 
2025-03-20 20:28:31.8934|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:28:31.8934|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:28:41.8243|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:28:51.2023|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:28:55.3462|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:28:55与配置名为：Test的PLC建立连接: 
2025-03-20 20:28:56.6234|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:29:02.7432|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:29:08.5652|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:29:08.5733|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:29:08.6696|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:29:08.6696|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:29:08.6696|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:29:16.6735|ERROR|ScheduledTasksService.S7.S7TaskService|后台任务执行失败 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
   at ScheduledTasksService.S7.S7TaskService.ExecuteAsync(CancellationToken stoppingToken) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\ScheduledTasksService\S7\S7TaskService.cs:line 85
2025-03-20 20:29:28.5379|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:29:43.9002|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:29:43与配置名为：Test的PLC建立连接: 
2025-03-20 20:29:47.6419|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:29:52.1692|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:31:08.8622|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:31:19.0528|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:31:25.4239|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|2025/3/20 20:31:25与配置名为：Test的PLC建立连接: 
2025-03-20 20:31:26.5762|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取：对配置名为：TestDB块进行读取，结果为3 
2025-03-20 20:31:32.7812|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行ing 
2025-03-20 20:31:39.9689|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:31:39.9760|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:31:40.0652|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:31:40.0652|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:31:40.0652|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 20:36:00.4989|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 20:36:17.9999|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行任务：Test 
2025-03-20 20:36:21.4932|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|与PLC Test 建立连接 
2025-03-20 20:36:27.8476|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 20:36:36.3563|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|开始执行任务：测试编辑 
2025-03-20 20:36:43.1857|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 20:36:43.1921|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 20:36:43.2875|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 20:36:43.2875|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 20:36:43.2875|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 23:25:29.1602|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 23:25:52.0526|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:26:02.6081|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:26:07.4822|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:26:22.5610|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:26:21.4952|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 23:26:31.4926|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 23:26:38.0657|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 23:26:38.0657|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 23:26:38.0657|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 23:26:41.4785|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 1 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:26:48.0336|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 2 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:26:51.0582|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:26:59.0449|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 3 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:27:32.1562|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 23:27:35.6702|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:27:35.6851|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:27:35.7121|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:27:35.8551|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 23:27:35.8551|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 23:27:35.9090|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 23:27:35.9092|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 23:27:35.9092|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 23:27:37.7775|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 1 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:27:41.8870|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 2 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:27:47.9648|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|PLC连接失败 (127.0.0.1:100)，正在第 3 次重试 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
2025-03-20 23:28:06.5732|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:28:06.5732|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:06.5985|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:28:06.5985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:06.6340|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:06.6695|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:06.7061|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:06.7398|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:08.8275|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:08.8312|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:08.8742|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:08.8742|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:08.9226|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:08.9573|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:08.9929|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:09.0247|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:11.0331|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:11.0357|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:11.0980|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:11.0980|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:11.1483|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:11.1987|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:11.2544|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:11.3140|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:13.3387|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:13.3387|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:13.3905|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:13.3905|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:13.4285|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:13.4608|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:13.4912|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:13.5189|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:15.5280|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:15.5280|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:15.5756|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:15.5756|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:15.6091|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:15.6363|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:15.6654|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:15.6941|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:17.7190|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:17.7225|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:17.7656|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:17.7656|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:17.8085|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:17.8434|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:17.8755|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:17.9051|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:19.9208|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:19.9208|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:19.9608|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:19.9608|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:20.0138|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:20.0784|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:20.1099|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:20.1481|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:22.1570|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:22.1607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:22.2233|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:22.2233|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:22.2851|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:22.3415|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:22.3902|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:22.4518|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:24.4726|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:24.4726|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:24.5143|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:24.5143|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:24.5478|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:24.5815|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:24.6154|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:24.6608|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:26.6772|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:26.6772|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:26.7309|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:26.7309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:26.7866|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:26.8403|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:26.8896|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:26.9383|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:28.9466|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:28.9466|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:29.0108|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:29.0108|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:29.0699|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:29.1266|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:29.1793|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:29.2302|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:31.2428|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:31.2428|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:31.2733|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:31.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:31.3014|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:31.3276|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:31.3555|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:31.3854|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:33.3997|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:33.3997|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:33.4549|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:33.4559|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:33.5061|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:33.5646|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:33.6109|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:33.6598|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:35.6844|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:28:35.6844|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:28:35.6844|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:35.6916|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:35.7227|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:35.7227|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:35.7547|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:35.7859|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:35.8167|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:35.8493|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:36.6174|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:28:37.8709|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:28:37.8709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:37.8709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:37.9282|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:37.9282|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:37.9854|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:38.0384|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:38.0860|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:38.1456|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:40.1529|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:40.1529|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:40.2190|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:40.2190|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:40.2672|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:40.3191|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:40.3653|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:40.4260|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:42.4476|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:42.4476|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:42.5758|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:42.5758|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:42.6840|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:42.7871|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:42.8952|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:42.9976|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:45.0084|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:45.0084|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:45.0847|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:45.0847|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:45.1554|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:45.2201|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:45.2833|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:45.3609|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:47.3740|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:47.3740|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:47.4267|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:47.4267|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:47.4789|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:47.5305|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:47.5775|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:47.6271|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:49.6343|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:49.6343|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:49.7384|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:49.7384|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:49.8364|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:49.9282|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:50.0241|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:50.1176|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:52.1271|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:52.1300|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:52.2667|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:52.2667|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:52.3805|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:52.4797|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:52.5809|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:52.6899|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:54.7057|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:54.7079|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:54.7667|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:54.7667|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:54.8158|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:54.8759|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:54.9322|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:54.9873|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:56.9981|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:56.9981|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:57.0510|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:57.0510|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:57.1051|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:57.1588|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:57.2101|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:57.2678|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:59.2863|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:28:59.2863|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:28:59.3716|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:59.3716|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:28:59.4511|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:59.5405|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:59.6251|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:28:59.7108|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:01.7203|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:01.7255|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:01.8343|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:01.8343|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:01.9497|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:02.0389|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:02.1360|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:02.2351|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:04.2593|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:04.2593|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:04.3577|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:04.3577|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:04.4357|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:04.5145|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:04.6047|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:04.6806|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:05.7262|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:05.7262|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:06.6369|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:06.7020|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:29:06.7020|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:06.7020|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:06.7823|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:06.7823|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:06.8536|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:06.9246|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:06.9984|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:07.0553|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:07.8976|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:09.0852|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:29:09.0852|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:09.0852|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:09.1649|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:09.1649|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:09.2519|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:09.3413|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:09.4190|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:09.5036|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:11.5208|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:11.5208|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:11.6463|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:11.6463|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:11.7550|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:11.8573|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:11.9888|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:12.0947|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:14.1200|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:14.1200|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:14.1853|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:14.1853|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:14.2366|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:14.3024|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:14.3710|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:14.4428|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:16.4573|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:16.4573|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:16.5691|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:16.5691|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:16.6742|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:16.7688|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:16.8721|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:16.9899|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:19.0046|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:19.0046|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:19.0741|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:19.0741|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:19.1337|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:19.1940|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:19.2519|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:19.3248|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:21.3363|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:21.3363|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:21.3868|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:21.3868|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:21.4356|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:21.4855|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:21.5312|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:21.5779|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:23.5942|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:23.5978|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:23.7004|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:23.7004|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:23.7974|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:23.8884|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:23.9878|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:24.0844|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:26.1000|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:26.1000|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:26.1935|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:26.1935|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:26.2494|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:26.3012|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:26.3530|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:26.4052|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:28.4223|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:28.4251|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:28.4762|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:28.4762|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:28.5269|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:28.5780|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:28.6272|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:28.6750|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:30.6825|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:30.6825|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:30.7821|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:30.7821|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:30.8781|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:30.9773|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:31.0724|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:31.1699|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:33.1888|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:33.1972|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:33.3261|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:33.3261|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:33.4481|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:33.5476|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:33.6412|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:33.7379|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:35.7114|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:35.7384|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:35.7635|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:29:35.7635|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:35.7693|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:35.8871|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:35.8871|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:36.0015|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:36.1040|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:36.2035|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:36.3046|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:36.6400|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:36.7243|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:37.9307|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:38.3272|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:29:38.3272|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:38.3272|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:38.3816|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:38.3816|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:38.4365|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:38.4887|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:38.5430|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:38.5956|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:39.1168|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:29:40.6146|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:29:40.6146|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:40.6146|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:40.7257|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:40.7257|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:40.8882|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:40.9872|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:41.0902|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:41.1849|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:43.1906|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:43.1951|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:43.3024|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:43.3024|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:43.4039|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:43.4994|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:43.5997|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:43.7122|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:45.7251|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:45.7251|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:45.7787|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:45.7787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:45.8276|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:45.8799|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:45.9283|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:45.9841|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:47.9970|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:47.9970|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:48.0613|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:48.0613|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:48.1214|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:48.1688|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:48.2191|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:48.2693|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:50.2862|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:50.2862|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:50.3686|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:50.3686|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:50.4451|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:50.5148|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:50.5944|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:50.6843|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:52.6948|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:52.6948|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:52.7533|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:52.7533|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:52.8026|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:52.8536|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:52.9050|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:52.9605|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:54.9663|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:54.9663|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:55.0198|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:55.0198|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:55.0680|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:55.1128|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:55.1605|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:55.2096|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:57.2177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:57.2177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:57.2907|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:57.2907|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:57.3655|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:57.4443|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:57.5155|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:57.5936|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:59.6148|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:29:59.6148|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:29:59.7202|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:59.7202|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:29:59.8203|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:29:59.9202|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:00.0162|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:00.1093|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:02.1187|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:02.1187|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:02.2166|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:02.2166|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:02.3245|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:02.4445|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:02.5506|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:02.6552|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:04.6659|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:04.6659|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:04.7733|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:04.7733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:04.8923|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:05.0032|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:05.0982|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:05.1967|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:05.7287|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:05.7287|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:05.7867|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:06.6393|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:06.7510|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:07.2086|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:07.2086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:07.2086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:07.2613|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:07.2613|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:07.3076|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:07.3576|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:07.4142|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:07.4713|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:07.9064|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:08.3617|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:09.1168|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:09.4950|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:09.4950|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:09.4950|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:09.5708|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:09.5708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:09.6522|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:09.7294|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:09.8050|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:09.8759|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:10.6449|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:11.8952|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:11.8952|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:11.8952|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:11.9426|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:11.9426|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:11.9819|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:12.0184|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:12.0574|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:12.0977|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:14.1096|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:14.1143|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:14.1610|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:14.1610|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:14.2092|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:14.2496|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:14.2882|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:14.3255|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:16.3399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:16.3399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:16.3909|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:16.3909|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:16.4409|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:16.4899|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:16.5396|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:16.5922|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:18.5956|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:18.5984|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:18.6415|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:18.6415|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:18.6924|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:18.7621|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:18.8462|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:18.9117|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:20.9287|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:20.9287|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:21.0294|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:21.0294|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:21.1368|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:21.2282|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:21.3168|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:21.4038|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:23.4130|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:23.4130|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:23.4801|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:23.4801|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:23.5371|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:23.5944|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:23.6482|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:23.7021|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:25.7062|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:25.7062|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:25.7550|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:25.7550|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:25.7997|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:25.8454|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:25.8924|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:25.9421|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:27.9595|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:27.9595|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:28.0231|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:28.0231|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:28.0767|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:28.1263|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:28.1806|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:28.2328|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:30.2478|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:30.2478|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:30.3489|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:30.3489|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:30.4396|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:30.5293|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:30.6224|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:30.7050|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:32.7231|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:32.7231|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:32.8178|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:32.8178|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:32.9043|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:32.9913|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:33.0789|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:33.1804|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.1931|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:35.1931|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:35.2501|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.2501|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:35.3000|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.3504|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.4028|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.4614|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:35.7338|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:35.7338|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:35.7939|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:36.6333|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:36.7263|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:37.2434|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:37.4889|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:37.4889|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:37.4889|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:37.6035|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:37.6035|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:37.7002|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:37.7926|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:37.8814|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:37.9769|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:37.9769|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:38.3591|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:39.1202|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:39.5280|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:39.9924|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:39.9924|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:39.9924|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:40.0451|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:40.0451|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:40.0939|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:40.1431|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:40.1987|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:40.2489|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:40.6484|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:41.9216|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:30:42.2693|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:42.2693|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:42.2693|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:42.2980|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:42.2980|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:42.3279|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:42.3566|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:42.3834|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:42.4109|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:44.4279|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:44.4279|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:44.4545|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:44.4545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:44.4788|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:44.5016|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:44.5253|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:44.5511|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:46.5580|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:46.5580|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:46.6234|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:46.6234|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:46.6857|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:46.7480|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:46.8156|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:46.8775|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:48.8851|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:48.8851|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:48.9326|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试编辑 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:48.9326|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:48.9762|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:49.0161|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-任务号-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:49.0577|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 粉料提升机-1001-起始位置-写 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:49.0916|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 测试 时发生错误 S7.Net.PlcException: Couldn't establish the connection to 127.0.0.1.
Message: 由于目标计算机积极拒绝，无法连接。
 ---> System.Net.Sockets.SocketException (10061): 由于目标计算机积极拒绝，无法连接。
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.TcpClient.CompleteConnectAsync(ValueTask task)
   at S7.Net.Plc.ConnectAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.OpenAsync(CancellationToken cancellationToken)
   at S7.Net.Plc.Open()
   --- End of inner exception stack trace ---
   at S7.Net.Plc.Open()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass10_0.<CreatePlcConnection>b__2() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 77
   at Polly.Policy.<>c__DisplayClass108_0.<Execute>b__0(Context _, CancellationToken _)
   at Polly.Policy.<>c__DisplayClass138_0.<Implementation>b__0(Context ctx, CancellationToken token)
   at Polly.Retry.RetryEngine.Implementation[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Action`4 onRetry, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider)
   at Polly.Retry.RetryPolicy.Implementation[TResult](Func`3 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Implementation(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action`2 action, Context context, CancellationToken cancellationToken)
   at Polly.Policy.Execute(Action action)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.CreatePlcConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 73
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass9_0.<GetConnection>b__1() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 46
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
--- End of stack trace from previous location ---
   at System.Lazy`1.CreateValue()
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.GetConnection(String ip, Int32 port) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 51
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 158
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:57.6110|ERROR|ScheduledTasksService.S7.S7TaskService|数据库初始化失败 
2025-03-20 23:30:57.7166|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:30:57.7166|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:57.7649|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:57.7863|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:30:57.7863|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:30:57.7863|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:30:57.7863|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:57.8312|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:30:57.8503|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:30:57.9393|INFO|Microsoft.Hosting.Lifetime|Now listening on: http://localhost:8888 
2025-03-20 23:30:57.9420|INFO|Microsoft.Hosting.Lifetime|Now listening on: https://localhost:8899 
2025-03-20 23:30:57.9971|INFO|Microsoft.Hosting.Lifetime|Application started. Press Ctrl+C to shut down. 
2025-03-20 23:30:57.9971|INFO|Microsoft.Hosting.Lifetime|Hosting environment: Development 
2025-03-20 23:30:57.9971|INFO|Microsoft.Hosting.Lifetime|Content root path: E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\PLCCommunicationAPI 
2025-03-20 23:30:59.9435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:30:59.9435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:30:59.9435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:30:59.9435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:30:59.9435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:30:59.9822|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:30:59.9822|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:30:59.9822|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:30:59.9822|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:30:59.9881|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:30:59.9881|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:30:59.9881|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:02.0047|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:02.0047|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:02.0047|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:02.0047|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:02.0047|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:02.0443|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:02.0443|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:02.0443|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:02.0443|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:02.0500|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:02.0500|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:02.0500|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:04.0702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:04.0702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:04.0702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:04.0702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:04.0702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:04.1376|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:04.1376|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:04.1376|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:04.1376|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:04.1376|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:04.1376|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:04.1452|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:06.1626|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:06.1626|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:06.1626|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:06.1626|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:06.1626|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:06.2072|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:06.2072|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:08.2309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:08.2309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:08.2309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:08.2309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:08.2309|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:08.2702|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:08.2702|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:10.2840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:10.2840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:10.2840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:10.2840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:10.2840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:10.3177|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:10.3177|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:12.3285|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:12.3308|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:12.3308|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:12.3308|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:12.3308|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:12.3755|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:12.3755|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:12.3780|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:12.3780|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:12.3780|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:12.3780|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:12.3780|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:14.3971|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:14.3971|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:14.3971|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:14.3971|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:14.3971|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:14.5648|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:14.5648|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:14.5677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:14.5677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:14.5677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:14.5677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:14.5677|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:16.5846|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:16.5846|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:16.5846|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:16.5846|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:16.5846|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:16.6513|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:16.6513|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:16.6513|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:16.6513|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:16.6513|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:16.6513|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:16.6608|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:18.6680|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:18.6680|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:18.6680|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:18.6760|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:18.6760|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:18.7413|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:18.7413|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:20.7601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:20.7601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:20.7601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:20.7601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:20.7601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:20.8746|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:20.8746|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:20.8787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:20.8787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:20.8787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:20.8787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:20.8787|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:22.8985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:22.8985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:22.8985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:22.8985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:22.8985|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:22.9630|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:22.9630|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:22.9630|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:22.9630|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:22.9630|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:22.9630|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:22.9720|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:24.9773|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:24.9773|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:24.9773|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:24.9773|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:24.9773|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:25.0907|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:25.0907|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:25.0983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:25.0983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:25.0983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:25.0983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:25.0983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:27.1188|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:27.1188|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:27.1188|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:27.1188|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:27.1188|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:27.1709|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:27.1709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:27.1709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:27.1709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:27.1758|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:27.1758|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:27.1758|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:27.7561|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:31:27.8198|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:31:29.1999|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:31:29.1999|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:29.2060|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:29.2060|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:31:29.2060|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:29.2060|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:29.2060|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:29.2730|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:29.2730|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:31.2960|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:31.2960|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:31.2960|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:31.3011|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:31.3011|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:31.3437|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:31.3437|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:31.3464|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:31.3464|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:31.3464|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:31.3464|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:31.3464|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:33.3613|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:33.3664|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:33.3664|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:33.3664|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:33.3664|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:33.4847|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:33.4847|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:33.4879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:33.4879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:33.4879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:33.4879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:33.4879|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:35.5104|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:35.5104|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:35.5104|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:35.5104|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:35.5104|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:35.6405|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:35.6405|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:35.6449|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:35.6449|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:35.6449|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:35.6449|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:35.6449|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:37.6722|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:37.6753|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:37.6753|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:37.6753|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:37.6753|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:37.7481|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:37.7481|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:37.7481|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:37.7481|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:37.7545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:37.7545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:37.7545|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:39.7729|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:39.7729|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:39.7729|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:39.7729|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:39.7729|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:39.8526|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:39.8526|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:39.8526|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:39.8526|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:39.8526|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:39.8526|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:39.8646|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:41.8704|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:41.8704|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:41.8704|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:41.8704|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:41.8704|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:41.9193|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:41.9193|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:41.9193|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:41.9193|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:41.9244|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:41.9244|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:41.9244|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:43.9399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:43.9399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:43.9399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:43.9399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:43.9399|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:44.0259|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:44.0259|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:44.0259|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:44.0259|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:44.0259|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:44.0259|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:44.0343|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:46.0540|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:46.0540|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:46.0540|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:46.0540|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:46.0540|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:46.1405|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:46.1405|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:46.1467|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:46.1467|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:46.1467|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:46.1467|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:46.1608|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:48.1721|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:48.1749|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:48.1749|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:48.1749|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:48.1749|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:48.2284|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:48.2284|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:48.2284|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:48.2284|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:48.2284|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:48.2284|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:48.2378|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:50.2442|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:50.2442|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:50.2442|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:50.2442|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:50.2442|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:50.2733|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:50.2733|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:52.2818|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:52.2857|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:52.2857|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:52.2857|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:52.2857|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:52.3133|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:52.3133|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:52.3156|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:52.3156|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:52.3156|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:52.3156|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:52.3156|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:54.3348|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:54.3348|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:54.3348|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:54.3348|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:54.3348|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:54.3737|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:54.3737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:54.3737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:54.3737|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:54.3796|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:54.3796|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:54.3796|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:56.3861|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:56.3861|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:56.3861|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:56.3861|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:56.3861|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:56.4435|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:56.4435|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:57.7455|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:31:57.8294|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:31:58.4701|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:31:58.4701|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:31:58.4724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:31:58.4724|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:31:58.4724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:31:58.4724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:31:58.4724|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:31:58.5320|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:31:58.5320|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:31:58.5352|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:31:58.5352|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:31:58.5352|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:31:58.5352|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:31:58.5352|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:31:59.2441|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:31:59.2744|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:00.5660|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:00.6225|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:00.6225|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:00.6225|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:00.6225|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:00.6282|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:00.6282|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:00.6282|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:02.6517|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:02.6517|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:02.6517|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:02.6517|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:02.6517|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:02.7091|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:02.7091|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:04.7265|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:04.7265|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:04.7265|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:04.7265|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:04.7265|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:04.8195|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:04.8195|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:06.8361|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:06.8361|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:06.8361|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:06.8361|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:06.8361|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:06.8983|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:06.8983|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:08.9210|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:08.9256|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:08.9256|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:08.9256|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:08.9256|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:08.9631|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:08.9631|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:10.9805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:10.9805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:10.9805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:10.9901|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:10.9901|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:11.0475|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:11.0475|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:11.0505|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:11.0505|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:11.0505|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:11.0505|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:11.0505|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:13.0731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:13.0731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:13.0731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:13.0731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:13.0731|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:13.1240|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:13.1240|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:13.1240|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:13.1275|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:13.1275|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:13.1275|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:13.1275|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:15.1535|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:15.1617|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:15.1617|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:15.1617|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:15.1617|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:15.2333|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:15.2333|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:15.2333|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:15.2333|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:15.2395|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:15.2395|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:15.2395|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:17.2578|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:17.2578|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:17.2578|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:17.2578|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:17.2578|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:17.3164|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:17.3164|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:19.3341|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:19.3341|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:19.3341|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:19.3341|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:19.3341|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:19.3895|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:19.3895|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:19.3895|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:19.3895|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:19.3951|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:19.3951|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:19.3951|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:21.4084|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:21.4115|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:21.4115|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:21.4115|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:21.4115|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:21.4936|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:21.4936|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:23.5196|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:23.5196|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:23.5196|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:23.5196|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:23.5196|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:23.5779|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:23.5779|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:23.5807|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:23.5807|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:23.5807|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:23.5807|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:23.5807|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:25.6045|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:25.6045|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:25.6045|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:25.6120|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:25.6120|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:25.6559|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:25.6559|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:25.6559|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:25.6559|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:25.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:25.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:25.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:27.6774|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:27.6774|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:27.6774|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:27.6774|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:27.6774|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:27.7428|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:27.7428|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:27.7428|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:27.7428|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:27.7428|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:27.7541|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:27.7541|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:27.7541|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:27.8210|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:28.5092|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:28.5197|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:29.2441|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:29.2441|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:29.7644|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:32:29.7644|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:29.7644|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:29.7709|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:32:29.7709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:29.7709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:29.7709|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:29.8201|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:29.8201|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:30.6158|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:100 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:30.6158|WARN|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|心跳检测失败：127.0.0.1:102 S7.Net.InvalidAddressException: H is not a valid address
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.PLCAddress..ctor(String address)
   at S7.Net.Plc.Write(String variable, Object value)
   at PLCCommunication_Infrastructure.Respository.PlcConnectionFactory.<>c__DisplayClass12_0.<StartHeartbeat>b__0(Object x) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\PlcConnectionFactory.cs:line 116
2025-03-20 23:32:31.8497|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:102 
2025-03-20 23:32:31.8497|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:31.8497|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:31.8497|INFO|PLCCommunication_Infrastructure.Respository.PlcConnectionFactory|成功建立PLC连接：127.0.0.1:100 
2025-03-20 23:32:31.8497|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:31.8620|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:31.8620|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:31.9150|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:31.9150|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:31.9150|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:31.9150|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:31.9150|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:31.9150|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:31.9269|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:33.9356|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:33.9409|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:33.9409|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:33.9409|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:33.9409|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:33.9965|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:33.9965|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:33.9965|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:33.9965|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:33.9965|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:33.9965|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:34.0040|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:36.0086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:36.0086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:36.0086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:36.0086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:36.0086|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:36.1119|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:36.1119|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:38.1283|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:38.1283|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:38.1283|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:38.1283|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:38.1283|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:38.1805|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:38.1805|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:40.2011|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:40.2011|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:40.2011|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:40.2077|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:40.2077|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:40.2607|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:40.2607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:40.2607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:40.2607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:40.2607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:40.2607|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:40.2679|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:42.2746|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:42.2746|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:42.2746|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:42.2869|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:42.2869|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:42.3581|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:42.3581|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:42.3648|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:42.3648|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:42.3812|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:42.3812|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:42.3812|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:44.4022|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:44.4022|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:44.4022|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:44.4094|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:44.4094|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:44.4601|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:44.4601|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:46.4829|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:46.4829|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:46.4829|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:46.4899|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:46.4899|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:46.5402|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:46.5402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:46.5402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:46.5402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:46.5402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:46.5402|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:46.5532|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:48.5653|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:48.5707|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:48.5707|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:48.5707|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:48.5707|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:48.6543|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:48.6543|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:48.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:48.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:48.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:48.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:48.6606|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:50.6840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:50.6840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:50.6840|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:50.6962|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:50.6962|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:50.7708|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:50.7708|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
2025-03-20 23:32:52.7892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：Test 
2025-03-20 23:32:52.7892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：Test，结果：3 
2025-03-20 23:32:52.7892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试编辑 
2025-03-20 23:32:52.7892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试编辑，结果：0 
2025-03-20 23:32:52.7892|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：test1 
2025-03-20 23:32:52.8422|ERROR|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|处理任务 test1 时发生错误 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at S7.Net.PLCAddress.Parse(String input, DataType& dataType, Int32& dbNumber, VarType& varType, Int32& address, Int32& bitNumber)
   at S7.Net.Plc.ReadAsync(String variable, CancellationToken cancellationToken)
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ProcessS7TaskAsync(S7ReadTask task) in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 164
   at PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity.ReadAsync() in E:\Code\前后端分离\WCS(PLCcommunication) v2.0\PLCCommunicationAPI\Infrastructure\Respository\S7ReadTaskResposity.cs:line 134
2025-03-20 23:32:52.8422|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-任务号-写 
2025-03-20 23:32:52.8422|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-任务号-写，结果：0 
2025-03-20 23:32:52.8422|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：粉料提升机-1001-起始位置-写 
2025-03-20 23:32:52.8479|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：粉料提升机-1001-起始位置-写，结果：0 
2025-03-20 23:32:52.8479|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|使用现有连接执行任务：测试 
2025-03-20 23:32:52.8479|INFO|PLCCommunication_Infrastructure.Respository.S7ReadTaskResposity|DB块读取成功：测试，结果：0 
